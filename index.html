<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SD VIBE PRO</title>
    <style>
        :root { --neon: #39FF14; --bg: #0b0b0b; }
        body { background: var(--bg); color: #fff; font-family: 'Poppins', sans-serif; margin: 0; padding-bottom: 150px; }
        
        /* Glass Header */
        .header { background: rgba(29, 185, 84, 0.2); backdrop-filter: blur(10px); padding: 25px; text-align: center; border-bottom: 2px solid var(--neon); }
        
        /* Login Modal */
        #login-overlay { position: fixed; inset: 0; background: #000; z-index: 1000; display: none; align-items: center; justify-content: center; text-align: center; }
        
        .search-box { display: flex; gap: 10px; padding: 15px; }
        input { flex: 1; padding: 12px; border-radius: 25px; border: 1px solid #444; background: #1a1a1a; color: white; outline: none; }
        .btn-neon { background: var(--neon); color: #000; border: none; padding: 10px 20px; border-radius: 25px; font-weight: bold; cursor: pointer; box-shadow: 0 0 10px var(--neon); }

        /* Music Card */
        .music-card { 
            background: rgba(255,255,255,0.05); margin: 8px 15px; padding: 10px;
            border-radius: 12px; display: flex; align-items: center; gap: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .album-art { width: 55px; height: 55px; border-radius: 8px; object-fit: cover; }
        .info { flex: 1; overflow: hidden; }
        .song-title { display: block; font-weight: bold; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* Bottom Player */
        .player-bar { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.95); padding: 15px; border-top: 2px solid var(--neon); z-index: 999; backdrop-filter: blur(10px); }
        .controls { display: flex; justify-content: center; align-items: center; gap: 20px; }
        #seekbar { width: 100%; accent-color: var(--neon); margin: 10px 0; }
        #hidden-yt { display: none; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div>
        <h1 style="color: var(--neon); margin-bottom: 5px;">SD VIBE PRO</h1>
        <p style="font-size: 12px; opacity: 0.7;">Enter your ID to Vibe</p>
        <input type="text" id="user-id-input" placeholder="User ID / Name" style="margin-bottom: 15px; text-align: center;"><br>
        <button class="btn-neon" onclick="saveLogin()">START VIBING</button>
    </div>
</div>

<div class="header">
    <h1 style="margin:0; font-size:20px;" id="display-name">üé∂ SD VIBE PRO</h1>
    <div style="display:flex; justify-content:center; gap:10px; margin-top:10px;">
        <button onclick="shareApp()" style="background:none; border:1px solid var(--neon); color:var(--neon); border-radius:10px; font-size:10px; padding:4px 8px;">üì§ SHARE APP</button>
        <button onclick="logout()" style="background:none; border:1px solid #ff4444; color:#ff4444; border-radius:10px; font-size:10px; padding:4px 8px;">LOGOUT</button>
    </div>
</div>

<div class="search-box">
    <input type="text" id="query" placeholder="Singer or Song Name...">
    <button class="btn-neon" onclick="searchMusic()">Search</button>
</div>

<div id="results"></div>

<div class="player-bar" id="player-ui" style="display:none;">
    <div id="play-title" style="font-size:11px; color:var(--neon); text-align:center; margin-bottom:5px; white-space:nowrap; overflow:hidden;">Song Name</div>
    <div style="display:flex; justify-content: space-between; font-size:10px; opacity:0.7;">
        <span id="time-curr">0:00</span>
        <span id="time-dur">0:00</span>
    </div>
    <input type="range" id="seekbar" value="0">
    <div class="controls">
        <button onclick="skip(-10)" style="background:none; border:none; color:white; font-size:22px;">‚è™</button>
        <button id="master-play" onclick="togglePlay()" style="background:var(--neon); border:none; width:45px; height:45px; border-radius:50%; font-size:20px;">II</button>
        <button onclick="skip(10)" style="background:none; border:none; color:white; font-size:22px;">‚è©</button>
    </div>
</div>

<div id="hidden-yt"><div id="main-player"></div></div>

<script>
    const API_KEY = 'AIzaSyBUk4Xa_ZALVYYfWIkpjoZrdx0lt57Y0Gw'; 
    let player, timer;

    // Persistent Login Check
    window.onload = function() {
        const savedName = localStorage.getItem('sd_vibe_user');
        if (savedName) {
            document.getElementById('display-name').innerText = "Vibe: " + savedName;
            searchMusic("Latest Bollywood Punjabi Hits 2024");
        } else {
            document.getElementById('login-overlay').style.display = 'flex';
        }
    };

    function saveLogin() {
        const name = document.getElementById('user-id-input').value;
        if (!name) return alert("Please enter your name!");
        localStorage.setItem('sd_vibe_user', name);
        location.reload(); // Reload to start app
    }

    function logout() {
        localStorage.removeItem('sd_vibe_user');
        location.reload();
    }

    function shareApp() {
        if(navigator.share) navigator.share({ title: 'SD VIBE PRO', url: window.location.href });
    }

    // Player Setup
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('main-player', {
            height: '0', width: '0',
            events: { 'onStateChange': (e) => { 
                if(e.data == YT.PlayerState.PLAYING) startTimer();
            }}
        });
    }

    async function searchMusic(q = null) {
        const query = q || document.getElementById('query').value;
        const resDiv = document.getElementById('results');
        resDiv.innerHTML = '<p style="text-align:center; font-size:12px;">Syncing Original Vibes...</p>';
        
        // Strict Original Audio Filter
        const finalQuery = query + " Official Music Video";
        const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=15&q=${encodeURIComponent(finalQuery)}&type=video&videoDuration=short&key=${API_KEY}`;
        
        try {
            const response = await fetch(url);
            const data = await response.json();
            resDiv.innerHTML = '';
            data.items.forEach((item) => {
                resDiv.innerHTML += `
                    <div class="music-card" onclick="playSong('${item.id.videoId}', '${item.snippet.title.replace(/'/g,"")}')">
                        <img class="album-art" src="${item.snippet.thumbnails.medium.url}">
                        <div class="info">
                            <span class="song-title">${item.snippet.title}</span>
                            <span style="font-size:10px; opacity:0.5;">Official Audio</span>
                        </div>
                        <div style="color:var(--neon)">‚ñ∂</div>
                    </div>`;
            });
        } catch(e) { resDiv.innerHTML = '<p>Limit reached. Try again later!</p>'; }
    }

    function playSong(id, title) {
        player.loadVideoById(id);
        document.getElementById('play-title').innerText = title;
        document.getElementById('player-ui').style.display = 'block';
        document.getElementById('master-play').innerText = 'II';
    }

    function startTimer() {
        clearInterval(timer);
        timer = setInterval(() => {
            const cur = player.getCurrentTime();
            const dur = player.getDuration();
            if(dur > 0) {
                document.getElementById('seekbar').max = dur;
                document.getElementById('seekbar').value = cur;
                document.getElementById('time-curr').innerText = fmt(cur);
                document.getElementById('time-dur').innerText = fmt(dur);
            }
        }, 1000);
    }

    function fmt(s) { 
        const m = Math.floor(s/60); s = Math.floor(s%60); 
        return m+":"+(s<10?'0':'')+s; 
    }

    function togglePlay() {
        if(player.getPlayerState() == 1) { player.pauseVideo(); document.getElementById('master-play').innerText = '‚ñ∂'; }
        else { player.playVideo(); document.getElementById('master-play').innerText = 'II'; }
    }

    function skip(s) { player.seekTo(player.getCurrentTime() + s, true); }
    document.getElementById('seekbar').oninput = function() { player.seekTo(this.value, true); };
</script>
</body>
</html>
